{%- comment -%}
  Dynamic Navbar Section - Responsive pill navbar with centered logo
{%- endcomment -%}

{%- style -%}
  #shopify-section-{{ section.id }} {
  --navbar-height: 56px;
  --navbar-radius: 32px;
  --navbar-padding: 6px;
  --navbar-gap: 24px;
  --navbar-logo-size: {{ section.settings.logo_width }}px;
  --navbar-bg: {{ section.settings.color_scheme.settings.background | default: '#d9d9d9' }};
  --navbar-text: {{ section.settings.color_scheme.settings.text | default: '#1f1f1f' }};
}

  .navbar {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    align-items: center;
    background: var(--navbar-bg);
    color: var(--navbar-text);
    border-radius: var(--navbar-radius);
    padding: 8px 24px;
    min-height: var(--navbar-height);
    max-height: 60px;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
    margin: 1rem auto;
    max-width: calc(100% - 2rem);
    width: 100%;
    gap: 32px;
    overflow: hidden;
    position: relative;
    isolation: isolate;
    background-color: var(--navbar-bg) !important;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
  }

  navbar-component[data-scroll-state="visible"] .navbar,
  navbar-component[data-scroll-state="hidden"] .navbar {
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  }

  .navbar::before,
  .navbar::after,
  .navbar *::before,
  .navbar *::after {
    content: none !important;
  }

  .navbar > * {
    position: relative;
    z-index: 1;
  }

  navbar-component {
  display: block;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  z-index: 9999;
  padding-top: 120px;
}

navbar-component[data-scroll-state="hidden"] {
}

  .navbar__container::before,
  .navbar__container::after {
    display: none !important;
  }

  /* LEFT SECTION: Menu */
  .navbar__menu-wrapper {
    grid-column: 1;
    justify-self: start;
    display: none;
  }

  @media (min-width: 768px) {
    .navbar__menu-wrapper {
      display: block;
    }
  }

  .navbar__menu-wrapper header-menu,
  .navbar__menu-wrapper .menu-list__list {
    display: flex !important;
    align-items: center;
    gap: var(--navbar-gap);
    list-style: none;
    margin: 0;
    padding: 0;
  }

  .navbar__menu-wrapper .menu-list__link {
    color: var(--navbar-text) !important;
    text-decoration: none !important;
    font-weight: 600 !important;
    font-size: 15px !important;
    padding: 4px 0 !important;
    white-space: nowrap;
    transition: color 0.2s ease;
  }

  .navbar__menu-wrapper .menu-list__link:hover {
    color: var(--color-accent, #000) !important;
  }

  /* CENTER SECTION: Logo */
  .navbar__logo {
    grid-column: 2;
    justify-self: center;
    align-self: center;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 48px;
    height: 48px;
    min-width: 48px;
    border-radius: 50%;
    background: var(--navbar-text);
    overflow: hidden;
    flex-shrink: 0;
    transition: transform 0.2s ease;
    z-index: 2;
  }
  
  .navbar__logo:hover {
    transform: scale(1.05);
  }
  
  .navbar__logo img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .navbar__logo-text {
    font-size: 14px;
    font-weight: 700;
    color: var(--navbar-bg);
    text-align: center;
  }

  /* RIGHT SECTION: Search + Actions */
  .navbar__right {
    grid-column: 3;
    justify-self: end;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  @media (min-width: 768px) {
    .navbar__search {
     background: white !important;
  border-radius: 9999px !important;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08) !important;
  border: 1px solid rgba(0, 0, 0, 0.05) !important;
  overflow: hidden !important;
  backdrop-filter: blur(10px);
    }
  }

  .navbar__search-input {
    border-radius: 9999px !important;
  border: none !important;
  background: transparent !important;
  height: 40px !important;
  padding: 0 44px 0 52px !important;
  font-size: 14px !important;
  line-height: 1.4 !important;
  }

  .navbar__search-input::placeholder {
    color: #8c8c8c;
  }

  .navbar__search-button {
    border-radius: 50% !important;
  width: 36px !important;
  height: 36px !important;
  margin: 2px !important;
  border: none !important;
  transition: all 0.2s ease !important;
  }

  .navbar__search-button svg {
    width: 16px;
    height: 16px;
  }

  /* Action Icons */
  .navbar__actions {
    display: flex;
    align-items: center;
    gap: 6px;
  }

  .navbar__action {
    color: var(--navbar-text);
    text-decoration: none;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    border-radius: 6px;
    transition: background 0.2s;
  }

  .navbar__action:hover {
    background: rgba(0, 0, 0, 0.06);
  }

  .navbar__action svg {
    width: 18px;
    height: 18px;
  }

  /* Mobile Menu Toggle */
.navbar__mobile-toggle {
  display: flex;
  align-items: center;
  justify-content: center;
  background: none;
  border: none;
  cursor: pointer;
  padding: 6px;
  color: var(--navbar-text);
  width: 36px;
  height: 36px;
  border-radius: 6px;
  transition: background 0.2s;
}

.navbar__mobile-toggle:hover {
  background: rgba(0, 0, 0, 0.06);
}

.navbar__mobile-toggle svg {
  width: 20px;
  height: 20px;
}

@media (min-width: 768px) {
  .navbar__mobile-toggle {
    display: none;
  }
}

/* PREMIUM DRAWER MENU - Half Screen with Backdrop */
.navbar__mobile-menu {
  position: fixed;
  left: 0;
  top: 0 !important;
  bottom: 0 !important;
  height: 100vh !important; /* Force full viewport height */
  width: 80%;
  max-width: 360px;
  background: #E0E0E0;
  z-index: 99999; /* Higher than navbar */
  transform: translateX(-100%);
  transition: transform 0.35s cubic-bezier(0.4, 0, 0.2, 1);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  box-shadow: 4px 0 24px rgba(0, 0, 0, 0.2);
  border-top-right-radius: 20px;
  border-bottom-right-radius: 20px;
}

/* Backdrop overlay - Full Viewport */
.navbar__mobile-menu::before {
  content: '';
  position: fixed;
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  bottom: 0 !important;
  width: 100vw !important;
  height: 100vh !important;
  background: rgba(0, 0, 0, 0.5);
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.35s ease, visibility 0.35s ease;
  pointer-events: none;
  z-index: -1;
}

.navbar__mobile-menu--open {
  transform: translateX(0);
}

/* Backdrop overlay */
.navbar__mobile-menu::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.35s ease, visibility 0.35s ease;
  pointer-events: none;
  z-index: -1;
}

.navbar__mobile-menu--open::before {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
}

/* Mobile Menu Header - FIXED */
.navbar__mobile-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 16px 18px;
  border-bottom: 1px solid rgba(0, 0, 0, 0.12);
  background: #E0E0E0;
  flex-shrink: 0;
  min-height: 60px;
}

.navbar__mobile-header .h4 {
  font-size: 20px;
  font-weight: 800;
  color: #1a1a1a;
  margin: 0;
  letter-spacing: 0.08em;
  text-transform: uppercase;
}

/* Close button styling */
.navbar__mobile-header .navbar__mobile-toggle {
  width: 36px;
  height: 36px;
  border-radius: 50%;
  background: #ffffff;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.16);
  transition: all 0.2s ease;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
}

.navbar__mobile-header .navbar__mobile-toggle:hover {
  background: #f5f5f5;
  transform: rotate(90deg);
}

.navbar__mobile-header .navbar__mobile-toggle svg {
  width: 16px;
  height: 16px;
  stroke-width: 2.5;
}

/* Mobile Menu Content Area - SCROLLABLE */
.navbar__mobile-content {
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
  min-height: 0;
  padding: 16px 18px 12px;
}

/* Custom scrollbar styling (optional) */
.navbar__mobile-content::-webkit-scrollbar {
  width: 6px;
}

.navbar__mobile-content::-webkit-scrollbar-track {
  background: #f5f5f5;
}

.navbar__mobile-content::-webkit-scrollbar-thumb {
  background: #ccc;
  border-radius: 3px;
}

.navbar__mobile-content::-webkit-scrollbar-thumb:hover {
  background: #999;
}

/* Drawer Search Bar */
.navbar__search--drawer {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 14px;
  background: #ffffff;
  border-radius: 999px;
  margin-bottom: 20px;
}

.navbar__search--drawer svg {
  width: 18px;
  height: 18px;
  color: #666;
  flex-shrink: 0;
}

.navbar__search--drawer-input {
  border: none;
  background: transparent;
  width: 100%;
  font-size: 14px;
  outline: none;
  color: #1a1a1a;
}

.navbar__search--drawer-input::placeholder {
  color: #999;
}

/* Mobile Menu List */
.navbar__mobile-list {
  list-style: none;
  padding: 0;
  margin: 0;
  min-height: min-content;
}

.navbar__mobile-item {
  border-bottom: 1px solid rgba(0, 0, 0, 0.08);
  transition: background 0.15s ease;
}

.navbar__mobile-item:last-child {
  border-bottom: none;
}

.navbar__mobile-item:active {
  background: rgba(255, 255, 255, 0.3);
}

/* Mobile Menu Links */
.navbar__mobile-link {
  display: block;
  padding: 14px 0;
  font-size: 24px;
  font-weight: 700;
  text-decoration: none;
  color: #111;
  transition: opacity 0.2s ease;
}

.navbar__mobile-link:active {
  opacity: 0.6;
}

/* Mobile Menu Footer - FIXED */
.navbar__mobile-footer {
  padding: 14px 18px 18px;
  border-top: 1px solid rgba(0, 0, 0, 0.12);
  background: #E0E0E0;
  flex-shrink: 0;
  min-height: 60px;
}

.navbar__mobile-footer-link--wishlist {
  display: flex;
  align-items: center;
  gap: 10px;
  font-size: 16px;
  font-weight: 600;
  text-decoration: none;
  color: #111;
  transition: opacity 0.2s ease;
}

.navbar__mobile-footer-link--wishlist:active {
  opacity: 0.6;
}

.navbar__mobile-footer-link--wishlist svg {
  width: 20px;
  height: 20px;
  flex-shrink: 0;
}

/* Staggered slide-in animation for menu items */
.navbar__mobile-menu--open .navbar__mobile-item {
  animation: slideInFromLeft 0.35s ease-out backwards;
}

.navbar__mobile-menu--open .navbar__mobile-item:nth-child(1) { animation-delay: 0.05s; }
.navbar__mobile-menu--open .navbar__mobile-item:nth-child(2) { animation-delay: 0.1s; }
.navbar__mobile-menu--open .navbar__mobile-item:nth-child(3) { animation-delay: 0.15s; }
.navbar__mobile-menu--open .navbar__mobile-item:nth-child(4) { animation-delay: 0.2s; }
.navbar__mobile-menu--open .navbar__mobile-item:nth-child(5) { animation-delay: 0.25s; }
.navbar__mobile-menu--open .navbar__mobile-item:nth-child(6) { animation-delay: 0.3s; }
.navbar__mobile-menu--open .navbar__mobile-item:nth-child(7) { animation-delay: 0.35s; }
.navbar__mobile-menu--open .navbar__mobile-item:nth-child(8) { animation-delay: 0.4s; }

@keyframes slideInFromLeft {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* Disable body scroll when menu is open */
body:has(.navbar__mobile-menu--open) {
  overflow: hidden;
}

/* Smaller screens */
@media (max-width: 360px) {
  .navbar__mobile-menu {
    width: 85%;
    max-width: 280px;
  }
}

/* Larger phones */
@media (min-width: 480px) {
  .navbar__mobile-menu {
    width: 75%;
    max-width: 340px;
  }
}

  /* MOBILE RESPONSIVE - FIX FOR HAMBURGER CLICKABILITY */
  @media (max-width: 767px) {
  .navbar {
    display: flex !important;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    padding: 8px 14px;
    border-radius: 30px;
    min-height: 52px;
    max-height: 56px;
    background: #E0E0E0 !important;
    box-shadow: 0 2px 10px rgba(0,0,0,0.08);
    position: relative;
  }

  .navbar__menu-wrapper {
    display: none !important;
  }

  /* Hamburger left */
  .navbar__mobile-toggle {
    display: flex !important;
    order: 1;
    flex-shrink: 0;
    width: 36px;
    height: 36px;
    border-radius: 8px;
    background: transparent;
    border: none;
    padding: 6px;
    cursor: pointer;
    color: #1f1f1f;
    position: relative;
    z-index: 10;
  }

  .navbar__mobile-toggle svg {
    width: 20px;
    height: 20px;
  }

  /* Center circular logo with black background */
  .navbar__logo {
    position: absolute !important;
    left: 50% !important;
    top: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 48px !important;
    height: 48px !important;
    min-width: 48px !important;
    border-radius: 50%;
    background: #000000 !important;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    z-index: 1;
  }

  .navbar__logo img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .navbar__logo-text {
    color: #ffffff;
    font-size: 14px;
    font-weight: 700;
  }

  /* Right icons (bag + profile ONLY) */
  .navbar__right {
    order: 3;
    margin-left: auto;
    display: flex !important;
    align-items: center;
    gap: 10px;
    flex-shrink: 0;
    position: relative;
    z-index: 10;
  }

  .navbar__search {
    display: none !important;
  }

  .navbar__actions {
    display: flex;
    align-items: center;
    gap: 8px;
    z-index: 1000;
    position: relative;
  }

  /* Hide search and wishlist icons on mobile */
  .navbar__action--search,
  .navbar__action--wishlist {
    display: none !important;
  }

  .navbar__action {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #1f1f1f;
    background: transparent;
  }

  .navbar__action svg {
    width: 18px;
    height: 18px;
  }
  }

  /* TABLET - Adjust spacing */
  @media (min-width: 768px) and (max-width: 1024px) {
    .navbar {
      gap: 20px;
      padding: 7px 18px;
      min-height: 52px;
      max-height: 56px;
    }

    .navbar__menu-wrapper header-menu,
    .navbar__menu-wrapper .menu-list__list {
      gap: 18px;
    }

    .navbar__menu-wrapper .menu-list__link {
      font-size: 14px !important;
      padding: 3px 0 !important;
    }

    .navbar__logo {
      width: 46px;
      height: 46px;
      min-width: 46px;
    }

    .navbar__search {
      min-width: 200px;
      max-width: 260px;
      padding: 6px 8px 6px 12px;
    }
  }

  /* LARGE SCREENS */
  @media (min-width: 1400px) {
    .navbar {
      max-width: 1400px;
    }
  }

  /* Sticky behavior */
  header-component[sticky='scroll-up'][data-scroll-direction='down'] .navbar {
    transform: translateY(calc(-1 * (var(--navbar-height) + 20px)));
    opacity: 0;
    pointer-events: none;
  }

  header-component[sticky='scroll-up'][data-scroll-direction='up'] .navbar,
  header-component[sticky='scroll-up'][data-scroll-direction='none'] .navbar {
    transform: translateY(0);
    opacity: 1;
    pointer-events: auto;
  }

  /* Very small screens */
  @media (max-width: 360px) {
    .navbar {
      padding: 6px 8px !important;
    }

    .navbar__logo {
      width: 38px !important;
      height: 38px !important;
      min-width: 38px !important;
    }

    .navbar__action {
      width: 28px !important;
      height: 28px !important;
    }

    .navbar__mobile-toggle {
      width: 32px !important;
      height: 32px !important;
    }
  }

/* CAPSULE SEARCH BAR WITH VERTICAL SCROLL ANIMATION */
@media (min-width: 768px) {
  .navbar__search.animated-search-container {
    position: relative;
    background: white;
    border-radius: 9999px;
    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
    border: 1px solid rgba(0, 0, 0, 0.05);
    min-width: 300px;
    max-width: 380px;
    height: 44px;
    display: flex;
    align-items: center;
  }

  .navbar__search.animated-search-container form {
    width: 100%;
    height: 100%;
    position: relative;
    display: flex;
    align-items: center;
  }

  .navbar__search-input {
    width: 100%;
    height: 100%;
    border-radius: 9999px;
    border: none;
    background: transparent;
    padding: 0 50px 0 20px;
    font-size: 14px;
    color: transparent;
    caret-color: #1f1f1f;
    outline: none;
  }

  .navbar__search-input:focus {
    color: #1f1f1f;
  }

  .navbar__search-input:focus ~ .search-placeholder,
  .navbar__search-input:not(:placeholder-shown) ~ .search-placeholder {
    opacity: 0;
    visibility: hidden;
  }

  /* Search button - no background */
  .navbar__search-button {
    position: absolute;
    right: 12px;
    top: 50%;
    transform: translateY(-50%);
    width: 24px;
    height: 24px;
    border: none;
    background: transparent;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    padding: 0;
    transition: opacity 0.2s ease;
  }

  .navbar__search-button:hover {
    opacity: 0.7;
  }

  .navbar__search-button svg {
    width: 18px;
    height: 18px;
    stroke: #666;
    stroke-width: 2;
  }

  /* Animated placeholder with vertical scroll */
  .search-placeholder {
  position: absolute;
  left: 20px;
  top: 0;
  bottom: 0;
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 14px;
  pointer-events: none;
  z-index: 10;
  transition: opacity 0.2s ease, visibility 0.2s ease;
  overflow: hidden;
  max-width: calc(100% - 80px);
  height: 100%;
}

  .search-placeholder .fixed {
    color: #8c8c8c;
  font-weight: 500;
  flex-shrink: 0;
  }

  .search-placeholder .animated {
  color: #1f1f1f;
  font-weight: 600;
  display: inline-block;
  transition: transform 0.3s ease-out, opacity 0.3s ease-out;
  transform: translateY(0);
  will-change: transform, opacity;
}

  /* Slide UP and fade out */
 .search-placeholder .animated.fade-out {
  opacity: 0;
  transform: translateY(-100%);
}

  /* Slide UP from bottom when appearing */
  .search-placeholder .animated.fade-in {
    animation: slideUpIn 0.3s ease-out forwards;
  }

  @keyframes slideUpIn {
     from {
    opacity: 0;
    transform: translateY(100%);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
  }
  
}

/* Utility class */
.hidden {
  display: none !important;
}

{%- endstyle -%}

<script src="{{ 'navbar.js' | asset_url }}" defer="defer"></script>

{%- liquid
  assign menu_handle = section.settings.menu | default: 'main-menu'
  assign menu_links = linklists[menu_handle].links
  capture menu_json
    echo '['
    for link in menu_links
      echo '{"id":"' | append: link.handle | append: '","label":"' | append: link.title | escape | append: '","url":"' | append: link.url | append: '"}'
      unless forloop.last
        echo ','
      endunless
    endfor
    echo ']'
  endcapture
-%}

<navbar-component
  class="navbar color-{{ section.settings.color_scheme }}"
  data-menu-data='{{ menu_json }}'
  {{ section.shopify_attributes }}
>
  <!-- Mobile Toggle (Left on mobile) -->
  <button 
    class="navbar__mobile-toggle" 
    id="mobile-menu-trigger"
    aria-label="Toggle menu"
    aria-expanded="false"
  >
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </button>

  <!-- Desktop Menu (Left) -->
  <div class="navbar__menu-wrapper">
    {%- content_for 'block', type: '_header-menu', id: 'header-menu' -%}
  </div>

  <!-- Logo (Center) -->
  <a href="{{ routes.root_url }}" class="navbar__logo">
    {%- if section.settings.logo != blank -%}
      {{- section.settings.logo 
        | image_url: width: section.settings.logo_width 
        | image_tag: 
          loading: 'eager', 
          width: section.settings.logo_width, 
          height: section.settings.logo_width,
          alt: shop.name
      -}}
    {%- else -%}
      <span class="navbar__logo-text">{{ shop.name | truncate: 10, '' }}</span>
    {%- endif -%}
  </a>

  <!-- Right Section: Search + Actions -->
  <div class="navbar__right">
    {%- if section.settings.show_search -%}
      <div class="navbar__search animated-search-container">
        <span class="search-placeholder">
          <span class="fixed">Search for </span>
          <span class="animated">Kurtis</span>
        </span>
        <form action="{{ routes.search_url }}" method="get" role="search">
          <input class="navbar__search-input" type="search" name="q" autocomplete="off" aria-label="Search products"/>
          <button class="navbar__search-button" type="submit" aria-label="Search">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.35-4.35"></path>
            </svg>
          </button>
        </form>
      </div>
    {%- endif -%}

    <div class="navbar__actions">
      {%- if section.settings.show_search -%}
        <a href="{{ routes.search_url }}" class="navbar__action navbar__action--search" aria-label="Search">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="11" cy="11" r="8"></circle>
            <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
          </svg>
        </a>
      {%- endif -%}

      {%- if section.settings.show_cart -%}
        <a href="{{ routes.cart_url }}" class="navbar__action" aria-label="Cart">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="9" cy="21" r="1"></circle>
            <circle cx="20" cy="21" r="1"></circle>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
          </svg>
        </a>
      {%- endif -%}

      {%- if section.settings.show_wishlist -%}
        <a href="/pages/wishlist" class="navbar__action navbar__action--wishlist" aria-label="Wishlist">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
          </svg>
        </a>
      {%- endif -%}
      
      {%- if section.settings.show_account and shop.customer_accounts_enabled -%}
        <a href="{%- if customer -%}{{ routes.account_url }}{%- else -%}{{ routes.account_login_url }}{%- endif -%}" 
           class="navbar__action" 
           aria-label="Account">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
        </a>
      {%- endif -%}
    </div>
  </div>
</navbar-component>

<!-- Mobile Menu Drawer - OUTSIDE navbar-component for full screen -->
<div class="navbar__mobile-menu" id="mobile-drawer">
  <div class="navbar__mobile-header">
    <span class="h4">MENU</span>
    <button 
      class="navbar__mobile-toggle" 
      id="mobile-menu-close"
      aria-label="Close menu"
    >
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
  </div>

  <div class="navbar__mobile-content">
    <div class="navbar__search--drawer">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"></circle>
        <path d="m21 21-4.35-4.35"></path>
      </svg>
      <input
        type="search"
        class="navbar__search--drawer-input"
        placeholder="Search for Kurtis"
        name="q"
        form="drawer-search-form"
      >
    </div>

    <ul class="navbar__mobile-list">
      {%- for link in menu_links -%}
        <li class="navbar__mobile-item">
          <a href="{{ link.url }}" class="navbar__mobile-link">
            {{ link.title }}
          </a>
        </li>
      {%- endfor -%}
    </ul>
  </div>

  <div class="navbar__mobile-footer">
    <a href="/pages/wishlist" class="navbar__mobile-footer-link--wishlist">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
      </svg>
      Your wishlist
    </a>
  </div>
</div>

<form id="drawer-search-form" action="{{ routes.search_url }}" method="get" class="hidden"></form>

<script>
// Mobile menu toggle
(function() {
  const trigger = document.getElementById('mobile-menu-trigger');
  const drawer = document.getElementById('mobile-drawer');
  const closeBtn = document.getElementById('mobile-menu-close');

  if (!trigger || !drawer) return;

  // Open menu
  trigger.addEventListener('click', () => {
    drawer.classList.add('navbar__mobile-menu--open');
    document.body.style.overflow = 'hidden';
  });

  // Close menu
  closeBtn?.addEventListener('click', () => {
    drawer.classList.remove('navbar__mobile-menu--open');
    document.body.style.overflow = '';
  });

  // Close on backdrop click
  drawer.addEventListener('click', (e) => {
    if (e.target === drawer) {
      drawer.classList.remove('navbar__mobile-menu--open');
      document.body.style.overflow = '';
    }
  });

  // Close on escape
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && drawer.classList.contains('navbar__mobile-menu--open')) {
      drawer.classList.remove('navbar__mobile-menu--open');
      document.body.style.overflow = '';
    }
  });
})();

// Desktop search animation
(function() {
  const container = document.querySelector('.animated-search-container');
  if (!container) return;

  const input = container.querySelector('.navbar__search-input');
  const animatedSpan = container.querySelector('.search-placeholder .animated');
  const placeholder = container.querySelector('.search-placeholder');
  
  if (!input || !animatedSpan) return;

  const terms = ['Kurtis', 'Sarees', 'Short Tops', 'Tube Tops', 'Trending', 'Summer fits'];
  let index = 0;
  let timeout;

  function nextTerm() {
    animatedSpan.classList.remove('fade-in');
    animatedSpan.classList.add('fade-out');
    
    setTimeout(() => {
      index = (index + 1) % terms.length;
      animatedSpan.textContent = terms[index];
      
      animatedSpan.classList.remove('fade-out');
      animatedSpan.classList.add('fade-in');
      
      setTimeout(() => animatedSpan.classList.remove('fade-in'), 400);
      timeout = setTimeout(nextTerm, 3000);
    }, 400);
  }

  timeout = setTimeout(nextTerm, 2000);

  input.addEventListener('focus', () => clearTimeout(timeout));
  input.addEventListener('blur', () => {
    if (!input.value.trim()) timeout = setTimeout(nextTerm, 2000);
  });
  input.addEventListener('input', (e) => {
    placeholder.style.opacity = e.target.value.length > 0 ? '0' : '1';
  });
})();
</script>


{% schema %}
{
  "name": "Dynamic Navbar",
  "settings": [
    {
      "type": "link_list",
      "id": "menu",
      "label": "Menu",
      "default": "main-menu"
    },
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
    {
      "type": "range",
      "id": "logo_width",
      "min": 40,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Logo width",
      "default": 60
    },
    {
      "type": "checkbox",
      "id": "show_search",
      "label": "Show search",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_cart",
      "label": "Show cart",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_wishlist",
      "label": "Show wishlist",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_account",
      "label": "Show account",
      "default": true
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    }
  ],
  "presets": [
    {
      "name": "Dynamic Navbar"
    }
  ]
}
{% endschema %}

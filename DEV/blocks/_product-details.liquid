{%- assign block_settings = block.settings -%}

<div
  id="ProductInformation-{{ section.id }}"
  class="
    product-details
    {% if block_settings.sticky_details_desktop %} sticky-content--desktop{% endif %}
    {% if block_settings.height == 'fill' -%} full-height--desktop{% endif -%}
  "
  style="--details-position: {{ block_settings.details_position }};"
  data-testid="product-information-details"
  {% if settings.transition_to_main_product %}
    data-view-transition-type="product-details"
  {% endif %}
>
  {% capture children %}
    <div class="view-product-title">
      <a
        href="{{ product.selected_or_first_available_variant.url }}"
        class="link"
      >
        {{- product.title }}
      </a>
    </div>

    {%- comment -%}
      Theme blocks (price, buy buttons, etc.) still render as usual.
      We simply hide the Accordion via CSS further below.
    {%- endcomment -%}
    {% content_for 'blocks' %}

    {%- comment -%}
      === QUICK FEATURES SECTION ===
      Static features displayed in a 2x2 grid above Product Details
      Positioned via CSS to appear before product description
    {%- endcomment -%}
    <section class="quick-features" aria-label="Product Features">
      <div class="qf-grid">
        <div class="qf-item">
          <img class="qf-icon" src="{{ 'return.svg' | asset_url }}" alt="" width="32" height="32" loading="lazy">
          <div class="qf-content">
            <h4 class="qf-title">7 Day Easy Return</h4>
          </div>
        </div>

        <div class="qf-item">
          <img class="qf-icon" src="{{ 'authentic.svg' | asset_url }}" alt="" width="32" height="32" loading="lazy">
          <div class="qf-content">
            <h4 class="qf-title">100% Authentic</h4>
          </div>
        </div>

        <div class="qf-item">
          <img class="qf-icon" src="{{ 'delivery.svg' | asset_url }}" alt="" width="32" height="32" loading="lazy">
          <div class="qf-content">
            <h4 class="qf-title">Free Delivery</h4>
          </div>
        </div>

        <div class="qf-item">
          <img class="qf-icon" src="{{ 'secureCheckout.svg' | asset_url }}" alt="" width="32" height="32" loading="lazy">
          <div class="qf-content">
            <h4 class="qf-title">Secure Checkout</h4>
          </div>
        </div>
      </div>
    </section>

    {%- comment -%}
      === Product Details (icons + text) ===
      Reads product metafields under namespace "custom":
      fabric, neckline, occasion, length, thread, embroidery, fit, washcare
    {%- endcomment -%}

    {%- assign mf = product.metafields.custom -%}

    {%- assign fabric_v = mf.fabric.value | default: '' | strip -%}
    {%- assign neckline_v = mf.neckline.value | default: '' | strip -%}
    {%- assign occasion_v = mf.occasion.value | default: '' | strip -%}
    {%- assign length_v = mf.length.value | default: '' | strip -%}
    {%- assign thread_v = mf.thread.value | default: '' | strip -%}
    {%- assign embroidery_v = mf.embroidery.value | default: '' | strip -%}
    {%- assign fit_v = mf.fit.value | default: '' | strip -%}
    {%- assign washcare_v = mf.washcare.value | default: '' | strip -%}

    {%- assign has_any_pd = false -%}
    {%- if fabric_v != '' or neckline_v != '' or occasion_v != '' or length_v != '' or thread_v != '' or embroidery_v != '' or fit_v != '' or washcare_v != '' -%}
      {%- assign has_any_pd = true -%}
    {%- endif -%}

    {%- if has_any_pd -%}
      <section class="pd-highlights" aria-labelledby="pd-title-{{ section.id }}">
        <div class="pd-wrap">
        <h3 id="pd-title-{{ section.id }}" class="pd-title">Product Specifications</h3>
        <div class="pd-title-underline" aria-hidden="true"></div>

        <ul class="pd-list" role="list">
  {%- comment -%} FABRIC {%- endcomment -%}
  {%- if fabric_v != '' -%}
    {%- assign _fabric_l = fabric_v | downcase -%}
    {%- assign fabric_txt = fabric_v -%}
    {%- unless _fabric_l contains 'fabric' -%}
      {%- assign fabric_txt = fabric_v | append: ' Fabric' -%}
    {%- endunless -%}
    <li class="pd-item">
      <img class="pd-icon" src="{{ 'fabric.svg' | asset_url }}" alt="Fabric icon" width="28" height="28" loading="lazy">
      <span class="pd-text">{{ fabric_txt }}</span>
    </li>
  {%- endif -%}

  {%- comment -%} NECKLINE {%- endcomment -%}
  {%- if neckline_v != '' -%}
    {%- assign _neck_l = neckline_v | downcase -%}
    {%- assign neckline_txt = neckline_v -%}
    {%- unless _neck_l contains 'neck' -%}
      {%- assign neckline_txt = neckline_v | append: ' Neckline' -%}
    {%- endunless -%}
    <li class="pd-item">
      <img class="pd-icon" src="{{ 'neckline.svg' | asset_url }}" alt="Neckline icon" width="28" height="28" loading="lazy">
      <span class="pd-text">{{ neckline_txt }}</span>
    </li>
  {%- endif -%}

  {%- comment -%} OCCASION {%- endcomment -%}
  {%- if occasion_v != '' -%}
    <li class="pd-item">
      <img class="pd-icon" src="{{ 'occasion.svg' | asset_url }}" alt="Occasion icon" width="28" height="28" loading="lazy">
      <span class="pd-text">{{ occasion_v }}</span>
    </li>
  {%- endif -%}

  {%- comment -%} LENGTH {%- endcomment -%}
  {%- if length_v != '' -%}
    {%- assign _len_l = length_v | downcase -%}
    {%- assign length_txt = length_v -%}
    {%- unless _len_l contains 'length' -%}
      {%- assign length_txt = length_v | append: ' Length' -%}
    {%- endunless -%}
    <li class="pd-item">
      <img class="pd-icon" src="{{ 'length.svg' | asset_url }}" alt="Length icon" width="28" height="28" loading="lazy">
      <span class="pd-text">{{ length_txt }}</span>
    </li>
  {%- endif -%}

  {%- comment -%} THREAD {%- endcomment -%}
  {%- if thread_v != '' -%}
    {%- assign _thread_l = thread_v | downcase -%}
    {%- assign thread_txt = thread_v -%}
    {%- unless _thread_l contains 'thread' -%}
      {%- assign thread_txt = thread_v | append: ' Thread' -%}
    {%- endunless -%}
    <li class="pd-item">
      <img class="pd-icon" src="{{ 'thread_pd.svg' | asset_url }}" alt="Thread icon" width="28" height="28" loading="lazy">
      <span class="pd-text">{{ thread_txt }}</span>
    </li>
  {%- endif -%}

  {%- comment -%} EMBROIDERY {%- endcomment -%}
  {%- if embroidery_v != '' -%}
    {%- assign _emb_l = embroidery_v | downcase -%}
    {%- assign embroidery_txt = embroidery_v -%}
    {%- unless _emb_l contains 'embroider' -%}
      {%- assign embroidery_txt = embroidery_v | append: ' Embroidery' -%}
    {%- endunless -%}
    <li class="pd-item">
      <img class="pd-icon" src="{{ 'embroidery.svg' | asset_url }}" alt="Embroidery icon" width="28" height="28" loading="lazy">
      <span class="pd-text">{{ embroidery_txt }}</span>
    </li>
  {%- endif -%}

  {%- comment -%} FIT {%- endcomment -%}
  {%- if fit_v != '' -%}
    {%- assign _fit_l = fit_v | downcase -%}
    {%- assign fit_txt = fit_v -%}
    {%- unless _fit_l contains 'fit' -%}
      {%- assign fit_txt = fit_v | append: ' Fit' -%}
    {%- endunless -%}
    <li class="pd-item">
      <img class="pd-icon" src="{{ 'fit.svg' | asset_url }}" alt="Fit icon" width="28" height="28" loading="lazy">
      <span class="pd-text">{{ fit_txt }}</span>
    </li>
  {%- endif -%}

  {%- comment -%} WASHCARE {%- endcomment -%}
  {%- if washcare_v != '' -%}
    <li class="pd-item">
      <img class="pd-icon" src="{{ 'washCare.svg' | asset_url }}" alt="Washcare icon" width="28" height="28" loading="lazy">
      <span class="pd-text">{{ washcare_v }}</span>
    </li>
  {%- endif -%}

</ul>
</div>
      </section>
    {%- endif -%}

  {% endcapture %}

  {% render 'group', children: children, settings: block_settings, shopify_attributes: block.shopify_attributes %}
</div>

{% stylesheet %}

  /* Clear padding on mobile, if not full-width */
  @media screen and (max-width: 749px) {
    .product-information.section--page-width .product-details > .group-block {
      padding-inline: 0;
    }
  }

  .view-product-title { display: none; }

  /* Container styles */
  .product-details {
    display: flex;
    align-self: start;
    justify-content: center;
  }

  @media screen and (min-width: 750px) {
    .product-details > .group-block { height: min-content; }
    .full-height--desktop {
      height: 100%;
      max-height: calc(100vh - var(--header-group-height, 0));
      min-height: fit-content;
    }
    .full-height--desktop .group-block {
      align-self: var(--details-position, 'flex-start');
    }
  }

  /* --- Hide the old accordion/dropdown --- */
  .product-details .accordion,
  .product-details [data-block-type="accordion"] {
    display: none !important;
  }
/* Hide the old accordion/dropdown in this area */
.product-details .accordion,
.product-details [data-block-type="accordion"],
.product-details .accordion__container,
.product-details .accordion-group,
.product-details .collapsible,
.product-details details {
  display: none !important;
}

/* === QUICK FEATURES SECTION === */
.quick-features {
  margin: 24px 0 32px 0;
  padding: 0;
  order: 100; /* High number to place it after buy buttons */
}

/* 2x2 Grid Layout */
.qf-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 16px 12px;
  max-width: 100%;
}

/* Each feature item */
.qf-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 0;
}

/* Icon styling */
.qf-icon {
  width: 28px;
  height: 28px;
  flex-shrink: 0;
  display: block;
  background: transparent !important;
}

/* Content wrapper */
.qf-content {
  flex: 1;
  min-width: 0;
}

/* Feature title */
.qf-title {
  font-family: inherit;
  font-size: clamp(14px, 1.5vw, 16px);
  font-weight: 600;
  line-height: 1.3;
  margin: 0;
  color: #111;
}

/* Tablet adjustments */
@media (min-width: 750px) and (max-width: 989px) {
  .qf-grid {
    gap: 18px 16px;
  }
  
  .qf-icon {
    width: 30px;
    height: 30px;
  }
  
  .qf-item {
    gap: 12px;
  }
}

/* Desktop adjustments */
@media (min-width: 990px) {
  .quick-features {
    margin: 28px 0 36px 0;
  }
  
  .qf-grid {
    gap: 20px 18px;
    max-width: 500px;
  }
  
  .qf-icon {
    width: 32px;
    height: 32px;
  }
  
  .qf-item {
    gap: 14px;
  }
  
  .qf-title {
    font-size: 16px;
  }
}

/* Mobile optimization */
@media (max-width: 749px) {
  .quick-features {
    margin: 20px 0 28px 0;
  }
  
  .qf-grid {
    gap: 14px 10px;
  }
  
  .qf-icon {
    width: 26px;
    height: 26px;
  }
  
  .qf-item {
    gap: 9px;
  }
  
  .qf-title {
    font-size: 14px;
  }
}

/* Make the parent container flexbox to support order property */
.product-details .group-block > * {
  display: flex;
  flex-direction: column;
}

/* Target product description block to appear after quick features */
.product-details [data-block-type="product-description"],
.product-details .product-description {
  order: 200;
}

/* === PRODUCT SPECIFICATIONS STYLE === */
.pd-highlights {
  margin-top: 20px;
  order: 300; /* Appears after product description */
}

.pd-wrap {
  display: inline-block;
}

/* Heading (Product Specifications) */
.pd-title {
  font-family: inherit;
  font-weight: 700;                     /* moderate boldness */
  font-size: clamp(19px, 1.8vw, 23px);  /* closer to your Figma look */
  text-transform: uppercase;
  letter-spacing: 0.3px;
  margin: 0;
  line-height: 1.1;
}

/* Underline – same width as icon+text block */
.pd-title-underline {
  width: 100%;
  height: 2px;
  background: currentColor;
  opacity: 0.25;
  margin: 8px 0 18px 0;
}

/* List Layout */
.pd-list {
  display: grid;
  grid-template-columns: 1fr;
  row-gap: 14px;
  padding: 0;
  margin: 0;
}

/* Each row */
.pd-item {
  display: flex;
  align-items: center;
  gap: 12px;
}

/* Icons – balanced size, clean alignment */
.pd-icon {
  width: 22px;
  height: 22px;
  flex: 0 0 22px;
  display: block;
  background: transparent !important;
}

/* Text – smaller and medium-weight */
.pd-text {
  font-family: inherit;
  font-size: clamp(15px, 1.6vw, 17px);
  font-weight: 500;
  color: #111;                          /* consistent dark text */
  line-height: 1.35;
}

@media (min-width: 990px) {
  .pd-icon {
    width: 23px;
    height: 23px;
  }
  .pd-list {
    row-gap: 16px;
  }
}
/* --- Match PRODUCT DETAILS heading style to PRODUCT SPECIFICATIONS --- */
.product-description h2,
.product-details h2,
.product-details .product__accordion-title,
.product-details .product__description-title,
.product-details .rte h2,
.product-details .rte strong:first-child,
.product-details .rte h3 {
  font-family: inherit;
  font-weight: 700;                     /* same boldness as Product Specifications */
  font-size: clamp(19px, 1.8vw, 23px);
  text-transform: uppercase;
  letter-spacing: 0.3px;
  margin: 0;
  line-height: 1.1;
  border-bottom: 2px solid currentColor;  /* underline same thickness */
  padding-bottom: 6px;
  display: inline-block;                /* makes underline width exact */
}

/* Optional: extra space below description paragraph before specs start */
.product-description + .pd-highlights,
.product-details + .pd-highlights {
  margin-top: 22px;
}

{% endstylesheet %}

{% schema %}
{
  "name": "t:names.details",
  "blocks": [
    { "type": "@theme" },
    { "type": "@app" },
    { "type": "text" },
    { "type": "icon" },
    { "type": "image" },
    { "type": "button" },
    { "type": "video" },
    { "type": "group" },
    { "type": "spacer" },
    { "type": "accordion" },
    { "type": "product-recommendations" },
    { "type": "price" },
    { "type": "variant-picker" },
    { "type": "buy-buttons" },
    { "type": "product-description" },
    { "type": "review" },
    { "type": "accelerated-checkout" },
    { "type": "_divider" },
    { "type": "product-inventory" }
  ],
  "tag": null,
  "settings": [
    { "type": "header", "content": "t:content.size" },
    { "type": "select", "id": "width", "label": "t:settings.width", "options": [
        { "value": "fit-content", "label": "t:options.fit_content" },
        { "value": "fill", "label": "t:options.fill" },
        { "value": "custom", "label": "t:options.custom" }
      ],
      "default": "fill"
    },
    { "type": "range", "id": "custom_width", "label": "t:settings.custom_width", "min": 0, "max": 100, "step": 1, "unit": "%", "default": 100, "visible_if": "{{ block.settings.width == 'custom' }}" },
    { "type": "select", "id": "width_mobile", "label": "t:settings.width_mobile", "options": [
        { "value": "fit-content", "label": "t:options.fit_content" },
        { "value": "fill", "label": "t:options.fill" },
        { "value": "custom", "label": "t:options.custom" }
      ],
      "default": "fill"
    },
    { "type": "range", "id": "custom_width_mobile", "label": "t:settings.custom_width", "min": 0, "max": 100, "step": 1, "unit": "%", "default": 100, "visible_if": "{{ block.settings.width_mobile == 'custom' }}" },
    { "type": "select", "id": "height", "label": "t:settings.height", "options": [
        { "value": "fit", "label": "t:options.fit_content" },
        { "value": "fill", "label": "t:options.fill" }
      ],
      "default": "fit"
    },
    { "type": "header", "content": "t:content.layout" },
    { "type": "select", "id": "details_position", "label": "t:settings.position", "options": [
        { "value": "flex-start", "label": "t:options.top" },
        { "value": "center", "label": "t:options.center" },
        { "value": "flex-end", "label": "t:options.bottom" }
      ],
      "default": "flex-start",
      "visible_if": "{{ block.settings.height == \"fill\" }}"
    },
    { "type": "range", "id": "gap", "label": "t:settings.gap", "min": 0, "max": 100, "step": 1, "unit": "px", "default": 12 },
    { "type": "checkbox", "id": "sticky_details_desktop", "label": "t:settings.make_details_sticky_desktop", "default": false },
    { "type": "header", "content": "t:content.appearance" },
    { "type": "checkbox", "id": "inherit_color_scheme", "label": "t:settings.inherit_color_scheme", "default": true },
    { "type": "color_scheme", "id": "color_scheme", "label": "t:settings.color_scheme", "default": "scheme-1", "visible_if": "{{ block.settings.inherit_color_scheme == false }}" },
    { "type": "select", "id": "background_media", "label": "t:settings.background_media", "options": [
        { "value": "none", "label": "t:options.none" },
        { "value": "image", "label": "t:options.image" },
        { "value": "video", "label": "t:options.video" }
      ],
      "default": "none"
    },
    { "type": "video", "id": "video", "label": "t:settings.video", "visible_if": "{{ block.settings.background_media == 'video' }}" },
    { "type": "select", "id": "video_position", "label": "t:settings.video_position", "options": [
        { "value": "cover", "label": "t:options.cover" },
        { "value": "contain", "label": "t:options.contain" }
      ],
      "default": "cover",
      "visible_if": "{{ block.settings.background_media == 'video' }}"
    },
    { "type": "image_picker", "id": "background_image", "label": "t:settings.image", "visible_if": "{{ block.settings.background_media == 'image' }}" },
    { "type": "select", "id": "background_image_position", "label": "t:settings.image_position", "options": [
        { "value": "cover", "label": "t:options.cover" },
        { "value": "fit", "label": "t:options.fit" }
      ],
      "default": "cover",
      "visible_if": "{{ block.settings.background_media == 'image' }}"
    },
    { "type": "select", "id": "border", "label": "t:settings.borders", "options": [
        { "value": "none", "label": "t:options.none" },
        { "value": "solid", "label": "t:options.solid" }
      ],
      "default": "none"
    },
    { "type": "range", "id": "border_width", "min": 0, "max": 10, "step": 0.5, "unit": "px", "label": "t:settings.border_width", "default": 1, "visible_if": "{{ block.settings.border != 'none' }}" },
    { "type": "range", "id": "border_opacity", "min": 0, "max": 100, "step": 1, "unit": "%", "label": "t:settings.border_opacity", "default": 100, "visible_if": "{{ block.settings.border != 'none' }}" },
    { "type": "range", "id": "border_radius", "label": "t:settings.border_radius", "min": 0, "max": 100, "step": 1, "unit": "px", "default": 0 },
    { "type": "header", "content": "t:content.padding" },
    { "type": "range", "id": "padding-block-start", "label": "t:settings.top", "min": 0, "max": 100, "step": 1, "unit": "px", "default": 0 },
    { "type": "range", "id": "padding-block-end", "label": "t:settings.bottom", "min": 0, "max": 100, "step": 1, "unit": "px", "default": 0 },
    { "type": "range", "id": "padding-inline-start", "label": "t:settings.left", "min": 0, "max": 100, "step": 1, "unit": "px", "default": 0 },
    { "type": "range", "id": "padding-inline-end", "label": "t:settings.right", "min": 0, "max": 100, "step": 1, "unit": "px", "default": 0 }
  ],
  "presets": [
    {
      "name": "t:names.details",
      "settings": {
        "width": "custom",
        "custom_width": 100,
        "padding-block-start": 0,
        "padding-block-end": 0,
        "padding-inline-start": 0,
        "padding-inline-end": 0,
        "gap": 12,
        "inherit_color_scheme": true,
        "color_scheme": "",
        "video_position": "cover",
        "background_image_position": "cover",
        "border": "none",
        "border_width": 1,
        "border_opacity": 100
      }
    }
  ]
}
{% endschema %}